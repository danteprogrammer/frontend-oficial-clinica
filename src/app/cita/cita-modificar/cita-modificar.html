<div class="form-container">
    <div class="header">
        <h2>Modificar Cita</h2>
    </div>

    <div *ngIf="cargando" class="loading">
        <p>Cargando información de la cita...</p>
    </div>

    <div *ngIf="mensajeError" class="mensaje error">{{ mensajeError }}</div>

    <form [formGroup]="modificarForm" (ngSubmit)="onSubmit()" *ngIf="!cargando && citaOriginal">
        <div class="form-grid">
            <div class="form-group full-width">
                <label for="pacienteInfo">Paciente</label>
                <input id="pacienteInfo" type="text" formControlName="pacienteInfo">
            </div>

            <div class="form-group">
                <label for="medicoId">Médico</label>
                <select id="medicoId" formControlName="medicoId" (change)="onMedicoChange()">
                    <option *ngFor="let med of medicos" [value]="med.idMedico">
                        Dr. {{ med.nombres }} {{ med.apellidos }}
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label for="estado">Estado de la Cita</label>
                <select id="estado" formControlName="estado">
                    <option value="Pendiente">Pendiente</option>
                    <option value="Confirmada">Confirmada</option>
                    <option value="Cancelada">Cancelada</option>
                </select>
            </div>

            <div class="form-group">
                <label for="fecha">Reagendar Fecha</label>
                <select id="fecha" formControlName="fecha" (change)="onFechaChange()">
                    <option *ngFor="let dia of diasDisponibles" [value]="dia">{{ dia | date:'fullDate' }}</option>
                </select>
            </div>

            <div class="form-group">
                <label for="hora">Reagendar Hora</label>
                <select id="hora" formControlName="hora">
                    <option *ngFor="let hora of horasDisponibles" [value]="hora">{{ hora }}</option>
                </select>
            </div>
        </div>

        <div class="form-actions">
            <button type="button" class="btn-cancelar" (click)="cancelar()">Cancelar</button>
            <button type="submit" [disabled]="modificarForm.invalid || cargando" class="btn-registrar">
                {{ cargando ? 'Actualizando...' : 'Guardar Cambios' }}
            </button>
        </div>
    </form>
</div>